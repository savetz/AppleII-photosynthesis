                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ BIO DEMO EXTENSIONS    < 2/22/86>141                                          PAGE                                    ." Loading virtuoso extensions"         CR CR CR                                PATCH                                                                             145     LOAD \ new opdb vars            150     LOAD \ BBALL                    165 179 THRU \ extensions               180 189 THRU \ reset and disk error     148     LOAD \ READ-IN                  146     LOAD \ char set adjustments                                           [FORTH]                                 WRITE-LOADER                            MARK-FORGET                             UNPATCH                                 3333 200 TONE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \ PREDEFINED VARIABLES   < 2/22/86>145                                          [FORTH] \ status variables              \ temporary variables                   LOADER PREVAR INT TINT                  LOADER PREVAR CHAR TCHAR                LOADER PREVAR LOGIC FLAG                \ left margin value                     LOADER PREVAR INT LMARG                                                                                                 LOADER VAR# @ EXEC TO 1stUserVar#       EXEC VP @ TO UserVP                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ bobp                                                                   ( CHARACTER SET ADJUST   < 2/22/86>146)                                                                                                                                                                 5 >COFFSET @ ASCII { >COFFSET !         4 >COFFSET @ ASCII } >COFFSET !                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ( FAH  )                                                                 \ RANDOM                 < 2/22/86>147                                          VARIABLE SEED                                                                   : RANDOM ( N -- I; 0 <= I < N )            SEED @ U* SWAP DROP                     SEED @ 27517 U* 2311 0 D+               DROP SEED ! ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ FAH                                                                    \ READ-IN                < 2/22/86>148                                                                                  EXCODE:                                    6 BUFFERS                               OPDB 0 @DISK DROP                            1024 @DISK DROP                    MSG-PTRS 0 @DISK DROP                   MSG-TEXT 0 @DISK DROP                   PICS 0 @DISK DROP                       CLEANUP                              EX;                                                                                                                     [KEYWORDS]                              : READ-IN                                 LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                                                                              \ FAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ BALL                   < 2/22/86>150  [EXEC]                                  4 CONSTANT BWID                         16 CONSTANT BHT                                                                 : DBALL ( X Y -- X Y )                    DDUP PACKBUF ROT ROT UNPACK ;                                                 : EBALL ( X Y -- X Y )                    GMODE @ >R 2 SETMODE                    OVER 7 * DUP BWID 7 * + SETENDPTS       DUP DUP BHT + VLINE                     R> SETMODE ;                                                                                                          -->                                                                                                                                                                                                                                                                                                                                                                                                                                     \ COURT                  < 2/22/86>151                                          : NET                                     5 SETMODE 18 HCOLOR 15 0                DO 20 I 2/ - 1                             230 I 4 / +  72 I + BAR              LOOP ;                                : COURT                                   HGR 5 SETMODE                           14 HCOLOR 280 4 0 181 BAR                6 HCOLOR 280 1 0 180 BAR                7 HCOLOR 4 130 270 50 BAR                        7 3 263 50 BAR                 5 HCOLOR 3 53 260 25 BAR                6 HCOLOR 34 2 224 70 BAR               NET                                   ;                                                                               -->                                                                                                                                                                                                                                                                                                             \ DRIBBLE PRIMITIVES     < 2/22/86>152                                          2 CONSTANT DS                           178 CONSTANT DBOT                       0 CONSTANT DTOP                         VARIABLE U/D                                                                    1 CONSTANT DF                           \ 1=allow key eexit, loop to keypress   \ 0=don't exit, dribble once                                                    : DEX? ( -- T/F; T=exit )                 DF QTERM AND ;                                                                                                                                                -->                                                                                                                                                                                                                                                                                                                                                                                             \ DRIBBLE                < 2/22/86>152  \ works best if ball starts on even lin : DROPBALL ( X Y -- X Y )                 2 SETMODE                               BEGIN DUP BHT + DBOT <                  WHILE OVER 7 * DUP BWID 7 * +            SETENDPTS DUP DUP DS 1- + VLINE         DS + DBALL DEX? IF EXIT THEN           REPEAT 100 2 TONE 0 U/D ! ;           : DRIBBLE ( X Y -- X Y )                  2 SETMODE U/D @                         IF \ ball is going down                  DROPBALL                               ELSE                                     BEGIN DUP DTOP >                        WHILE OVER 7 * DUP BWID 7 * +            SETENDPTS                               DUP BHT + DUP DS - SWAP VLINE           DS - DBALL DEX?                         IF EXIT THEN                           REPEAT 1 U/D !                         THEN ;                                -->                                                                                                                                             \ POSITION BALL          < 2/22/86>154  : BOOP 200 5 TONE ;                     : PBALL ( -- X Y )                        GHOME 5 SETMODE                         G." Position ball with arrow keys,"   GCR G." then press return to shoot."      2 134 DUP ' DTOP ! 1 U/D ! 1 ' DF !     2 ' DS !                                BEGIN                                    BEGIN QTERM NOT WHILE DRIBBLE REPEAT    KEY >R EBALL DDUP                       R@  8 = IF SWAP 1- SWAP THEN            R@ 21 = IF SWAP 1+ SWAP THEN            >R DUP 0<                               IF DROP OVER BOOP THEN                  DUP 38 BWID - >                         IF DROP OVER BOOP THEN                  R>                                      DSWAP DDROP DBALL R> 13 =              UNTIL                                   0 ' DF ! DRIBBLE  U/D @ 0=              IF DRIBBLE THEN ;                     -->                                                                                                                                             \ FIXED POINT TRIG       < 2/22/86>155  VARIABLE #XS                            : TRM                                      #XS @ SWAP / NEGATE 10000 */            10000 + ;                            : {SIN}                                    DUP DUP 10000 */ #XS !                  10000 72 TRM 42 TRM 20 TRM 6 TRM        10000 */ ;                           : ?MIRROR                                  DUP 90 >                                IF 180 SWAP - THEN ;                 : REDUCE                                   360 MOD DUP 0< IF 360 + THEN            DUP 180 < IF ?MIRROR                    ELSE 180 - ?MIRROR NEGATE THEN ;     : ISIN ( N -- SIN*10000 )                  REDUCE 17543 100 */ {SIN} ;          : ICOS ( N -- COS*10000 )                  360 MOD 90 SWAP - ISIN ;             : ITAN ( N -- TAN*10000 )                  DUP ISIN SWAP ICOS ?DUP                 IF 100 SWAP */ ELSE 3 * THEN ;       -->                            \ FAH                                                                    \ DOSHOOT variables      < 2/22/86>156                                          CREATE DD 4 ALLOT ( last ball draw )    VARIABLE SANG ( 25-80 )                 VARIABLE SPOW ( 5-25 )                  VARIABLE RISE ( *10 )                   VARIABLE RUNA ( *10 )                   VARIABLE XTOT                           VARIABLE YTOT                           -5 CONSTANT GRAV                        0 CONSTANT SX                           0 CONSTANT SY                                                                   -->                                                                                                                                                                                                                                                                                                                                                                                                                                            \ FAH                                                                    \ BOUNCE                 < 2/22/86>157                                          : <BOUNCE>                                 RUNA @ DUP 0> \ rebound it              IF 300 2 TONE 2/ NEGATE                 THEN RUNA ! ;                                                                : BOUNCE ( X Y -- X' Y' )                  >R >R ( I=X I'=Y )                      \ check if hit rim?                     70 I' DUP BHT + 2+ WITHIN               I BWID + 31 33 WITHIN AND               IF R> DROP 32 BWID - R>                  <BOUNCE>                               ELSE \ bounce on backboard?              I' BHT + 25 > I' BHT + 70 < AND         I BWID + 36 > AND \ backb               IF R> DROP 37 BWID - R>                  <BOUNCE>                               ELSE R> R>                              THEN                                   THEN ;                                                                       -->                            \ FAH                                                                    \ INBASKET?              < 2/22/86>158                                          : INBASKET? ( X Y -- X Y T/F; T=score)     >R >R ( I=X I'=Y )                      I 30 38 BWID - WITHIN                   70 I' DUP BHT + WITHIN                  RISE @ 0< AND                           AND R> SWAP R> SWAP ;                                                        : MISSED? ( X Y -- X Y T/F; T=DONE )       >R >R ( I=X I'=Y )                   \ off top or bottom?                        I' 10 < I' 140 > RISE @ 0< AND OR   \ of left or right  ?                      I 4 < RUNA @ 0< AND                     I BWID + 37 > RUNA @ 0> AND OR       \ in net                                   I 32 BWID - >                           I' 73 88 WITHIN AND                     OR OR                                   R> SWAP R> SWAP ;                                                            -->                                                                                                                                             \ DOSHOOT                < 2/22/86>157                                          : DOSHOOT ( -- )                          SPOW @ SANG @ ISIN 1000 */ RISE !       SPOW @ SANG @ ICOS 1000 */ RUNA !       0 XTOT ! 0 YTOT ! 0 0 DD D!             BEGIN                                    XTOT @ 70 / SX +                        SY YTOT @ 10 / -                        INBASKET?                               IF DDROP DD D@ EBALL DDROP 5 SETMODE     G." Score!" 4 TO DS                     32 86 DROPBALL DDROP EXIT THEN         BOUNCE MISSED? DUP >R NOT               IF DD D@ ?DUP                            IF EBALL DDROP ELSE DROP THEN           DBALL DD D!                             RUNA @ XTOT +!                          RISE @ YTOT +! GRAV RISE +!            ELSE DDROP THEN R>                     UNTIL                                   DD D@ EBALL DDROP NET                   G." Missed!"                          ; -->                                                                                                   \ SHOOT                  < 2/22/86>158                                          : SHOOT ( X Y -- )                        GHOME 2 SETMODE 280 22 0 0 BAR          5 SETMODE TO SY TO SX SX 27 >           IF EBALL                                 G." You do not have a shot."         \  GCR G." press any key" KEY DROP      \  GHOME 2 SETMODE 280 22 0 0 BAR       \  5 SETMODE                              ELSE G." Enter shot angle (25-80): "     25 80 PAD 2 GETN SANG ! GCR             G." Enter shot speed (1-10): "          1 10 PAD 2 GETN 4 + SPOW !              2 SETMODE 280 22 0 0 BAR GHOME          5 SETMODE                               G." Press any key to shoot."            KEY DROP                                2 SETMODE 280 22 0 0 BAR GHOME          5 SETMODE                               DOSHOOT                                THEN                                  ;                                       -->                            \ FAH                                                                    \ BBALL                  < 2/22/86>159                                                                                  : BBALL                                   2 GETPIC                                BEGIN                                    COURT PBALL SHOOT                    \  GHOME 2 SETMODE 280 22 0 0 BAR          5 SETMODE GCR                           G." Try another shot (Y/N)? "           BEGIN GKEY TOUC DUP 78 =                  OVER 89 = OR NOT                      WHILE DROP REPEAT                       DUP GEMIT 78 =                         UNTIL ;                                                                       -->                                                                                                                                                                                                                                                                                                                                                                                             \ BBALL                  < 2/22/86>162                                                                                  IS-EXCODE BBALL                                                                                                         [KEYWORDS]                                                                      : BBALL                                   LOADER INSCR? !EXCODE ;                                                                                                                                       [FORTH]                                                                                                                                                                                                                                                                                                                                                                                                                                        \ FAH                                                                    \                        < 2/22/86>163                                                                                  100 CONSTANT RR                         20 CONSTANT RS                          3  CONSTANT D                                                                   : RAH                                     BEGIN                                    RR RANDOM RS + D <TONE>                 ?TERMINAL                              UNTIL ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ FAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ( COLORS                 <12/27/85>165)                                         [FORTH]                                                                         : WHITE1   3 HCOLOR ;                   : WHITE2   7 HCOLOR ;                   : WHITE    WHITE2 ;                     : BLACK1   0 HCOLOR ;                   : BLACK2   4 HCOLOR ;                   : BLACK    BLACK2 ;                     : GREEN    2 HCOLOR ;                   : PURPLE   1 HCOLOR ;                   : BLUE     5 HCOLOR ;                   : ORANGE   6 HCOLOR ;                                                           : 1COLORS                                 ' WHITE1 CFA TO WHITE                   ' BLACK1 CFA TO BLACK ;                                                       : 2COLORS                                 ' WHITE2 CFA TO WHITE                   ' BLACK2 CFA TO BLACK ;                                                                                      ( bobp )                                                                 ( COLORS                 <12/27/85>166)                                         0 WARNING !                             EXCODE: WHITE EX;                       [KEYWORDS]                              : WHITE                                   LOADER INSCR? !EXCODE ;                                                       EXCODE: BLACK EX;                       [KEYWORDS]                              : BLACK                                   LOADER INSCR? !EXCODE ;                                                       EXCODE: GREEN EX;                       [KEYWORDS]                              : GREEN                                   LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                                                                              ( bobp )                                                                 ( COLORS                 <12/27/85>167)                                         EXCODE: PURPLE EX;                      [KEYWORDS]                              : PURPLE                                  LOADER INSCR? !EXCODE ;                                                       EXCODE: BLUE EX;                        [KEYWORDS]                              : BLUE                                    LOADER INSCR? !EXCODE ;                                                       EXCODE: ORANGE  EX;                     [KEYWORDS]                              : ORANGE                                  LOADER INSCR? !EXCODE ;                                                       1 WARNING !                                                                                                                                                                                                                                                                    ( bobp )                                                                 ( NEXT-LINE NL NL-IND    <12/27/85>168)                                         \ sames as: AT LASTX , LASTY + P/L      EXCODE: \ -- ;                            LASTX @ CURX ! LASTY @ P/L @            + DUP LASTY ! CURY ! EX;                                                      [KEYWORDS] \ use: NEXT-LINE             : NEXT-LINE                               LOADER INSCR? !EXCODE ;               : NL                                      LOADER INSCR? !EXCODE ;                                                       \ same as: AT LASTX , LASTY + 10        \          LET CURX := CURX + 15        EXCODE: \ -- ;                            LASTX @ 15 + CURX !                     LASTY @ 10 + DUP LASTY ! CURY ! EX;                                           [KEYWORDS] \ USE: NL-IND                : NL-IND                                  LOADER INSCR? !EXCODE ;                                                                                      ( bobp )                                                                 ( DO-MENU2               <12/27/85>169)                                         EXCODE:                                   EP @ NEXT-EP ! LAST-DEP @ NEXT-EP 2+    BEGIN M-ITEM# @ 4 ^MITEMS @ GO-CODE      ( execute IF-PLACED arguments )         MCURS KEY MENU-KEY? ?DUP                IF SWAP DROP       ( key pressed )       ^MKEYS 1+ @ GO-CODE                    ELSE ( check movement keys )             DUP >R BL =       ( move down )         IF  1 M-ITEM# +! THEN                   M-ITEM# @ 1- #MITEMS @ +                #MITEMS @ MOD 1+ M-ITEM# ! ( wrap )     R> 13 =           ( selected? )         IF M-ITEM# @ 6 ^MITEMS @ GO-CODE       THEN THEN                              AGAIN EX;                                                                                                                                                                                                                                                                    ( bobp )                                                                 ( DO-MENU2               <12/27/85>170)                                         [KEYWORDS]                              : DO-MENU2 ( -- )                          LOADER END-MENU                         !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ( bobp )                                                                 ( WAIT                   <12/27/85>171)                                                                                 EXCODE: WAIT                            EX;                                                                             [KEYWORDS]                                                                      : WAIT                                    LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ( bobp )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \ MYRESET                < 2/22/86>180  [FORTH]                                                                         VARIABLE BRK-SCR                        \ holds the OpDB address of the         \ screen to run when reset is pressed   : MYRESET                                 MODE40 CLS HG                         \ EMPTY-BUFFERS                           5 SETMODE DX' @ DX !                    0 34 C! ( reset text margin )           BRK-SCR @ EXEC DEP !                    BEGIN READ-SCR NOT                      WHILE SCR-BUF RUN-CODE REPEAT           RUN-ERR" err 180"                     ;                                                                                                                                                                                                                                                                                                                                                              \ FAH                                                                    \ BRK-SCREEN             < 2/22/86>181  \ use: BRK-SCREEN name                  \ vectors in MYRESET into BRK-RETN      \ when crtl-RESET is pressed            \ control will transfer to this screen                                          \ args: ADR ,                           EXCODE: \ -- ;                            REVECTOR MYRESET INTO BRK-RETN          @2ARG BRK-SCR ! EX;                                                           [KEYWORDS]                              ( use: BRK-SCREEN name )                : BRK-SCREEN ( -- ; )                     LOADER INSCR?                           !EXCODE <INTER> ;                                                                                                                                                                                                                                                                                                                                            \ FAH                                                                    \ >RLAST RETRY           < 2/22/86>182  [FORTH]                                 CREATE RLAST 14 ALLOT                                                           : >RLAST \ copys to 7 args to RLAST       SP@ RLAST 14 CMOVE ;                                                          HEX                                     \ retrys last argument saved by         \ >RLAST returns error status           \ /\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\  \ \ DOES NOT GO TO DISKERR if error  /  \  \/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/                                           : RETRY \ -- Err ; retry last             0 0C                                    DO RLAST I + @ -2 +LOOP                 RLAST @ 6 PICK 10 * B7E9 C!             <RWTS> DUP DISK-ERROR ! ;                                                     DECIMAL                                                                                                                                                \ FAH                                                                    \ RWTS PATCH             < 2/22/86>183  [FORTH]                                                                         \ saves calling arguments so it can     \ be retried if error                                                           \ ' [RWTS] CFA ' RWTS ! enables         \ ' DEPTH CFA ' RWTS ! disables                                                 : [RWTS] ( <7 ARGS> -- <7 ARGS> DEPTH )   >RLAST DEPTH ;                                                                                                        ' [RWTS] CFA ' RWTS !                   CR CR ." RWTS PATCHED" CR CR                                                                                                                                                                                                                                                                                                                                                                           \ FAH                                                                    \ .DERR                  < 2/22/86>184  [FORTH]                                 \ if space pressed, return              \ else execute BRK-RETN                 : .DERR ( -- ; print message )            PAGE TEXT CR 1500 50 TONE               7 7  XYTAB                              ." A DISK ERROR HAS OCCURRED"           7 8 XYTAB OUT @ 0 DO 45 EMIT LOOP       9 11 XYTAB                              ." CHECK DISK AND DRIVE"                7 13 XYTAB                              ." THEN PRESS SPACE TO RETRY"           5 15 XYTAB                              ." OR ESC TO RETURN TO MAIN MENU"       BEGIN KEY DUP BL = OVER 27 = OR NOT     WHILE DROP REPEAT                       27 =                                    IF HG BRK-RETN PAGE TEXT                  ABORT THEN                            PAGE ;                                                                                                                                               \ FAH                                                                    \ DISK-OOPS              < 2/22/86>185  \ handles disk errors                   \ does not destroy HI-RES screen        \ Will leave in text mode               \ if csw does not point to BIOS         [FORTH]                                   XVAR OLDCSW                           : DISK-OOPS                               54 @ OLDCSW !  \ remember character                    \ output routine         BEGIN .DERR    \ tell user                    RETRY 0= \ until succesful        UNTIL                                   PAGE           \ clear text screen      OLDCSW @ DUP 65008 =                    \ 65008=adr of screen output routine    IF HG THEN     \ if not printing        54 ! ;         \ restore COUT routine                                         REVECTOR DISK-OOPS INTO DISKERR CR CR   ." DISKERR REVECTORED INTO DISK-OPPS"   CR CR                                                                                                          \ FAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    