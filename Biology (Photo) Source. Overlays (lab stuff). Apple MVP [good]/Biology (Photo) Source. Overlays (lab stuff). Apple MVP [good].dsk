\                        <12/17/86>140                                                                                  BEGIN                                     SERIES-INIT                             EXPER-TYPE 2 LET TINT := 0              BEGIN                                 \  SET-INT# TINT                           GET-RESULT                              IF NOT FLAG THEN                         LET TINT := TINT + 2                    NEXT-EXPER                              IF FLAG THEN MODE 5                      CLS PR-RESULTS PRINT "JSDJS"            PR-INTS PRINT "ASDJH"                   SCREEN-DONE                            ENDIF                                  ENDIF                                   REPEAT                                 END                                   END                                                                                                                                                                                                                             \ LOADBLOCK              <11/20/86>141  PAGE                                    ." Loading BIOLOGY overlays" CR CR CR   PATCH                                   ." PUT RUN COMPILE IN A PRESS A KEY"    KEY DROP CR CR                                                                    250 259 THRU \ overlay stuff            145     LOAD \ RUN patch                185 222 THRU \ graph/input results      260 275 THRU \ Excodes                [FORTH] OVSET \ now load some overlays!                                         \ 0: rate of photosynthesis lab 1       10 START-OV                               165 184 THRU \ Rate of photo lab      0 !OVERLAY 0OVERLAY                                                             -->                                                                                                                                                                                                                                                                                                             \ LOADBLOCK              <11/ 6/86>142                                          \ 1:misc stuff                          15 START-OV                               150 151 THRU \ reaction timer           155 164 THRU \ animated ion             225 234 THRU \ Drk reac cycle anim    1 !OVERLAY 0OVERLAY                                                             \ 2: dark reaction lab                  10 START-OV                               235 244 THRU \ Drk reac lab           2 !OVERLAY 0OVERLAY                                                                                                     CR CR                                   ." PUT SYSTEM DISK IN A, PRESS A KEY"   KEY DROP CR CR                                                                  [FORTH] -1 SAVE-VDP ! \ force update    WRITE-LOADER                            MARK-FORGET 3 BUFFERS                                                                                                                                                                   \ TO NULLIFY X WORDS     <11/19/86>143                                                                                  : X: [COMPILE] : ;                                                              : X; [COMPILE] ;                        ; IMMEDIATE                                                                     : X' [COMPILE] '                        ; IMMEDIATE                                                                     : XVARIABLE VARIABLE ;                  : XCONSTANT CONSTANT ;                  : XCREATE CREATE ;                                                                                                                                                                                                                                                                                                                                                                                                                             \ FAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ RUN PATCH              <11/ 6/86>145                                          : RUN                                     [ ' VARIABLES @ ] LITERAL               ' VARIABLES !                           0OVERLAY                                RUN ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \ FAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ RTIME                  <11/ 6/86>150  \ wait a random amount of time          \ make a tone TINT is the number of     \ milisecs it took the user to react    VARIABLE RT                             0 OWORD:                                  0 RT ! 9 RANDOM 9 + EXEC WAIT           BEGIN 3 WAIT ?TERMINAL NOT UNTIL        FORTH 3000 5 TONE ?TERMINAL DROP        BEGIN 1 RT +!                            1 DROP 1 DROP \ time killers            QTERM RT @ 9999 > OR                   UNTIL                                   ?TERMINAL DROP 4000 5 TONE              RT @ TINT !                             EXEC CLEANUP FORTH O;                 EXIT ------------                                                               EXCODE: \ -- ;                            0 1 OEXEC EX;                                                                 KEY: RTIME                                LOADER INSCR? !EXCODE ;                                              \ FAH                                                                    \ PR-CYCLES              <11/ 6/86>151  \ print RT (reaction time)                                                      1 OWORD:                                  RT @ 999 >                              IF RT @ 1000 / G. 44 GEMIT               RT @ 1000 MOD DUP 100 <                 IF 48 GEMIT THEN DUP 10 <               IF 48 GEMIT THEN                       THEN                                    RT @ 1000 MOD G.                        G." ,000,000"                           EXEC CLEANUP FORTH O;                                                         EXIT                                                                            EXCODE: \ --                              1 1 OEXEC EX;                                                                 KEY: PR-CYCLES                            LOADER INSCR? !EXCODE ;                                                                                                                              \ FAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ ION NOTES              <11/ 6/86>155                                          EXIT --------- notes ------------ EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \ FAH                                                                    \ ION VARIABLES          <11/ 6/86>156                                          120 XCONSTANT IX  \ ion x                40 XCONSTANT IY  \ ion y                12 XCONSTANT LX  \ light X              36 XCONSTANT LY  \ light Y               0 XCONSTANT LTN \ light number                                                VARIABLE L1NXY 0 , 0 ,                  VARIABLE L2NXY 0 , 0 ,                                                          X: IVL ( Y1 Y2 )                           IY + SWAP IY + VLINE X;                                                      X: ILN ( N -- )                            DUP IVL X;                                                                   X: IXP ( X1 X2 -- )                       IX + SWAP IX + SETENDPTS X;                                                                                                                                                                                                          \ FAH                                                                    \ ION H+                 <11/ 6/86>157                                          X: ION ( -- )                              5  9 IXP 0 ILN 11 ILN                   3 11 IXP  1 ILN 10 ILN                  2 12 IXP  2 ILN  9 ILN                  1 13 IXP  3 ILN  8 ILN                  0 14 IXP  4 7 IVL X;                                                         X: H+                                      3  3 IXP 3 8 IVL   \ left H             7  7 IXP 3 8 IVL   \ right H            3  6 IXP 5 ILN     \ middle H           9 11 IXP 3 ILN     \ hor +             10 10 IXP 2 4 IVL X; \ ver +                                                  X: DOLT                                    LTN DUP NOT X' LTN !                    IF L1NXY @ L1NXY 2+ D@ <DRAW>           ELSE L2NXY @ L2NXY 2+ D@ <DRAW>         THEN X;                                                                                                                                             \ FAH                                                                    \ BG-SAVE BG-RESTORE     <11/ 6/86>158                                                                                  X: BG-SAVE                                 IX 7 / 12 0                             DO DUP IY I + YADDR +                    PAD I 4 * + 4 CMOVE                    LOOP DROP X;                                                                 X: BG-REST                                 IX 7 / 12 0                             DO DUP IY I + YADDR +                    PAD I 4 * + SWAP 4 CMOVE               LOOP DROP X;                                                                                                                                                                                                                                                                                                                                                                                                                                \ FAH                                                                    \ ION-FLASH H+-FLASH     <11/ 6/86>159                                          X: LTOFF                                   0 L1NXY ! 0 L2NXY ! X;                                                       X: ION-FLASH                               BG-SAVE 1 SETMODE ION 0 SETMODE         10 0 DO DOLT ION LOOP                   BG-REST LTOFF X;                                                             X: H+-FLASH                                BG-SAVE 1 SETMODE ION                   2 SETMODE H+ 0 SETMODE 10 0             DO DOLT ION LOOP                        BG-REST LTOFF X;                                                             X: IPOS                                    GX @ X' IX ! GY @ X' IY ! X;                                                                                                                                                                                                                                                                                                                         \                        <12/23/86>160                                          \ use: AT X , Y LPOS N                  2 OWORD: ( N --  ; L1POS )                ( N ) L1NXY !                           GX @ 7 / GY @ L1NXY 2+ D! O;                                                  3 OWORD: ( N --  ; L2POS )                ( N ) L2NXY !                           GX @ 7 / GY @ L2NXY 2+ D! O;                                                  4 OWORD: ( -- ; ION )                     IPOS ION-FLASH O;                                                             5 OWORD: ( -- ; H+ )                      IPOS H+-FLASH O;                                                              12 OWORD: ( IM H+M -- )                   IPOS GETMODE >R                         SWAP SETMODE ION SETMODE H+             R> SETMODE O;                                                                                                                                        \ FAH                                                                    \ FORGET HEADS           <11/ 7/86>161                                                                                  [FORTH]                                                                         FORGET IX                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ FAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ experiment vars        <11/ 6/86>165                                          \ XVARIABLE INT#                        \ index to intensity 0-20               \ which represents 0-2000 mEnstiens                                             \ XVARIABLE TEMP#                       \ index to tempurature 0-6              \ which represents 10-40 degress c                                                                                      \ compiles 7 nummbers from input        \ stream as bytes                       X: ,L                                     7 0 DO SNUM C, LOOP X;                                                                                                XCREATE B/M                                                                     \ data on next screen                                                                                                                                                                          \ FAH                                                                    \ PHOTO DATA TABLE       <10/ 4/86>181  ( mE   ) ( 10 15 20 25 30 35 40 deg c)  (    0 ) ,L 0  0  0  0  0  0  0         (  100 ) ,L 2  3  2  2  2  1  1         (  200 ) ,L 4  5  5  5  5  3  3         (  300 ) ,L 9 10 10 10 10  7  5         (  400 ) ,L 13 14 14 15 15 10  7        (  500 ) ,L 15 16 17 18 19 15  9        (  600 ) ,L 15 20 21 21 21 18 11        (  700 ) ,L 15 24 27 28 29 20 13        (  800 ) ,L 15 24 31 31 31 23 15        (  900 ) ,L 15 24 34 34 34 27 18        ( 1000 ) ,L 15 24 35 36 37 30 22        ( 1100 ) ,L 15 24 35 36 41 33 26        ( 1200 ) ,L 15 24 35 37 44 35 29        ( 1300 ) ,L 15 24 35 37 47 38 31        ( 1400 ) ,L 15 24 35 39 52 42 34        ( 1500 ) ,L 15 24 35 39 55 45 36        ( 1600 ) ,L 15 24 35 39 55 45 36        ( 1700 ) ,L 15 24 35 39 55 45 36        ( 1800 ) ,L 15 24 35 39 55 45 36        ( 1900 ) ,L 15 24 35 39 55 45 36        ( 2000 ) ,L 15 24 35 39 55 45 36                                       \ FAH                                                                    \ BUB/MIN                <12/29/86>167                                                                                                                          \ uses INT# TEMP# to extract value      \ from the table                        X: BUB/MIN ( -- N )                        B/M INT# @ 7 * + TEMP# @ + C@ X;                                             X: >ML/HR ( BUB/MIN -- ML/HR )             23 * 1000 MIN X;                                                             X: ML/HR ( -- N*1000)                      BUB/MIN >ML/HR X;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ EXPER VARIABLES        <11/ 6/86>168                                                                                  XVARIABLE BUB-EY \ ending y value (top) XVARIABLE BUB-MX \ middle x value                                               XVARIABLE BUBX \ current bubble values  XVARIABLE BUBY                                                                  \ location for the clock                XVARIABLE CLKXY 0 ,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ FAH                                                                    \ DBUB                   <11/ 6/86>169                                          \ draw bub at BUBX BUBY                 \ assumes proper mode is set            X: DBUB                                    BUBX @ 1- BUBX @ 1+ SETENDPTS           BUBY @ 1+ HLINE                         BUBX @ 2- BUBY @ DOT                    BUBX @ 1+ BUBY @ DOT                    BUBX @ 1- BUBX @ 1+ SETENDPTS           BUBY @ 1- HLINE X;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \ FAH                                                                    \ FLOAT-BUB              <11/ 6/86>170  \ float bubble to the top of the        \ surface. Starts 90 lines below        \ BUB-EY (which should be line num      \ of top of the water) randomly moves   \ BUBX +-8 pixels from BUB-MX                                                   X: FLOAT-BUB ( -- )                       GMODE C@ >R 0MODE                       BUB-MX @ 16 RANDOM - 36 + BUBX !        BUB-EY @ 98 + BUBY ! DBUB               BEGIN BUBY @ BUB-EY @ 8 + >             WHILE DBUB -6 BUBY +! DBUB              REPEAT DBUB                             BUBX @ 2- BUBY @ 1- DOT                 BUBX @ BUBY @ 2-  DOT                   BUBX @ 2+ BUBY @ 1- DOT                 100 0 DO NOOP LOOP                      BUBX @ 2- BUBY @ 1- DOT                 BUBX @ BUBY @ 2-  DOT                   BUBX @ 2+ BUBY @ 1- DOT                 100 0 DO NOOP LOOP                      R> SETMODE                            X;                             \ FAH                                                                    \ BUB-DEL                <11/ 6/86>171  \ should take the same amount of time   \ to execute as FLOAT-BUB                                                       X: BUB-DEL                                2450 0                                  DO NOOP LOOP                          X;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \ FAH                                                                    \ RANARR                 < 1/ 2/86>172                                          \ creates a 60 byte array filled with   \ n 1's in random order at PAD          XVARIABLE RINC                                                                  X: RANARR ( N -- )                         PAD 61 0 FILL ?DUP                      IF 60 OVER / RINC ! ( N ) 0              DO 1 PAD I RINC @ * +                    RINC @ 2/ + C!                         LOOP                                    30 0                                    DO PAD 60 RANDOM + >R                    PAD 60 RANDOM + >R                      I C@ I' C@ R> C! R> C!                 LOOP                                   THEN X;                                                                      \ get item n from array                 X: @RANARR ( N -- M )                      PAD + C@ X;                                                                                                 \ FAH                                                                    \ BUB-EXPER              < 1/ 2/86>173                                          \ do bubble experiment                  X: BUB-EXPER ( -- )                       GMODE C@ @CURSOR BUB/MIN DUP            IF DUP 10 / RANDOM 2 RANDOM              IF NEGATE THEN +                       THEN 40 MIN RANARR 61 0                 DO CLKXY D@ !CURSOR                      2MODE 14 10 CLKXY D@ BAR                5MODE 60 I - G.                         I @RANARR                               IF FLOAT-BUB ELSE BUB-DEL               THEN                                    1100 0 DO NOOP LOOP                    LOOP                                    800 10 TONE                             !CURSOR SETMODE X;                                                            EXIT                                    : T 200 40 CLKXY D!                       0  BUB-MX ! 0 BUB-EY !                  S2 BUB-EXPR ;                                                        \ FAH                                                                    \ DROP-LEV               <11/ 6/86>174                                          \ drops manometer level BUB-MX BUB-EY   \ is top left of man. graphic           \ BUBY is current level                 X: DROP-LEV                                GMODE C@ 2MODE                          BUB-MX @ 20 + DUP 18 + SETENDPTS        BUBY @ 6 + HLINE                        SETMODE                              X;                                                                              X: LEV-DEL                                 1050 0 DO NOOP LOOP                  X;                                                                                                                                                                                                                                                                                                                                                                                                     \ FAH                                                                    \ MAN-EXPER              < 4/ 1/87>175  XVARIABLE LVAL                          \ do manometer experiment               X: MAN-EXPER ( -- )                       GMODE C@ @CURSOR ML/HR DUP              IF DUP 10 / RANDOM 2 RANDOM              IF NEGATE THEN                          + 25 /                                 THEN DUP LVAL ! RANARR                  BUB-EY @ BUBY ! 61 0                    DO CLKXY D@ !CURSOR                      2MODE 14 10 CLKXY D@ BAR                5MODE 60 I - G.                         I @RANARR                               IF DROP-LEV 1 BUBY +! THEN              LEV-DEL                                 2600 0 DO NOOP LOOP                    LOOP                                    800 10 TONE                             !CURSOR SETMODE X;                    EXIT ---                                : M 200 40 CLKXY D!                       0 BUB-MX ! 0 BUB-EY !                   S1 MAN-EXPR ;                \ FAH      ù‹  v„  ñ|  ,v  #p  Új  Ñg  …e  ûc  ±d  èf  ^k  ×r  Ñ{  
‡    \ ELO-IDEAL              <12/23/86>176                                          \ get ideal data point number i         X: @IDP ( I -- V )                         7 * B/M + TEMP# @ + C@                  BUB/MAN @ 0=                            IF >ML/HR 50 + 100 / THEN            X;                                                                              \ draw ideal graph for current temp     X: ELO-IDEAL                               50 0 @IDP >SCRPOS POINT 20 1            DO I 100 * I @IDP >SCRPOS LINE-TO       LOOP                                 X;                                                                                                                                                                                                                                                                                                                                                                                                     \ FAH                                                                    \ EXPER-POS CLOCK-POS    <12/23/86>177                                          0 OWORD:                                  CURX @ BUB-MX !                         CURY @ BUB-EY ! O;                                                            1 OWORD:                                  GXY@ CLKXY D! O;                                                              EXIT --- load earlier ---- EXIT                                                 EXCODE: 0 0 OXEC EX;                                                            KEY: EXPER-POS                            LOADER INSCR? !EXCODE ;                                                       EXCODE: 1 0 OXEC EX;                                                                                                    KEY: CLOCK-POS                            LOADER INSCR? !EXCODE ;                                                                                                                              \ FAH                                                                    \ SET-INT# SET-TEMP#     <12/23/86>178                                          2 OWORD: ( N -- ) INT# ! O;             3 OWORD: ( N -- ) TEMP# ! O;                                                    EXIT --- load earlier ---- EXIT                                                 EXCODE: ( N -- ) 2 0 OEXEC EX;          \ USE: SET-INT# n                       \ sets intensity index (INT#)           KEY: SET-INT#                             LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                                                             EXCODE: ( N -- ) 3 0 OEXEC EX;          \ USE: SET-TEMP# n                      \ sets temperature index (TEMP#)        KEY: SET-TEMP#                            LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                            \ FAH                                                                    \ RUN-EXPER              <12/23/86>179                                          4 OWORD: ( -- )                           BUB/MAN @                               IF BUB-EXPER                            ELSE MAN-EXPER                          THEN                                    EXEC CLEANUP FORTH O;                                                         EXIT --- load earlier ---- EXIT                                                 EXCODE: ( -- ) 5 0 OEXEC EX;            \ USE: RUN-EXPER                        \ execute experiment (type set by       \ EXPER-TYPE                            KEY: RUN-EXPER                            LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                                                                              \ FAH                                                                    \ SHOW-MAN               <12/23/86>180                                          5 OWORD: ( -- )                           GMODE C@ BUB-EY @ BUBY !                LVAL @ ?DUP                             IF 0                                     DO DROP-LEV 1 BUBY +!                   LOOP                                   THEN                                    SETMODE                                 EXEC CLEANUP FORTH O;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \ ELO-IDEAL              <12/23/86>181                                          6 OWORD:                                  ELO-IDEAL O;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \ FAH                                                                    \                        <12/23/86>182                                          [FORTH]                                                                         FORGET ,L                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ FAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ( BIOGRAPH -- DOCUMENTAT <12/27/85>185)                                         EXIT                                                                            Code for CBS Biology photosynthesis     graphing routines is on screens 150 -   173. These routines assume graphs will  be drawn in reverse on hires screen.                                            XPOS  and YPOS give the coordinate of   the upper left corner of the coordinate plane.                                                                          YRANGE and YRANGE hold the xy           dimensions of the plane.                                                        XMAX and YMAX hold the maximum x and    y values that can be plotted.                                                   An autoscaling routine, TICS, is used   to compute and draw the tick marks.                                                                                                                    ( bobp )                                                                 ( BIOGRAPH -- DOCUMENTAT <12/27/85>186)                                         EXIT                                                                            TICS presumes that XRANGE, YRANGE,      XMAX, and YMAX are evenly divisable     by 2 and 5.                                                                     Data to be plotted is stored in         EXPER-DATA. #SERIES holds the maximum   number of experimental runs. The        maximum number of data points in a run  is determined by MAX-EXPERS. MAX-SERIES holds the maximun number of runs.       SERIES# is the current run in the       series. EXPER# points to the current    data point. TEMP is the temperature     value associated with the run.          SCALE scales the print function for     the coordinate labeling numbers.        SCALE can range from 0 through 5.       INIT initializes VALUES, EXPER# and     SCALE.                                                                 ( bobp )                                                                 ( BIOGRAPH -- DOCUMENTAT <12/27/85>187) EXIT ----                               DISPLACEMENT draws the coordinate       plane for the manometer setup in        CBS Biology Photosynthesis.                                                     BUBBLES draws the coordinate plane      for the bubbles setup.                                                          PLOT-EM plots the data points in        VALUES.                                                                         GRAPH-EM connects the points with       lines.                                                                          WIPEGRAPH erases the coordinate         plane.                                                                                                                                                                                                                                                                                                                 ( bobp )                                                                 \ XPOS YPOS XRANGE YRANGE<11/ 6/86>188  [FORTH]                                  170 XCONST XPOS    \ Position of upper   60 XCONST YPOS    \ left corner of                        \ coordinate plane                                           100 XCONST XRANGE  \ XY dimension        40 XCONST YRANGE  \ of coordinate                         \ plane                0 XCONST XMIN    \ minimum x value   2000 XCONST XMAX    \ Maximum values of   10 XCONST YMAX    \ xy data                                                      7 XCONST MAX-EXPERS                       \ Maximum number of experiments                                               5 XCONST MAX-SERIES                       \ Maximum number experimental           \ runs                                                                          VARIABLE BUB/MAN                        VARIABLE INT#                           VARIABLE TEMP#                                                                                                                             \ SCALE EXPER# #SERIES   <11/ 6/86>189                                          \ XVAR SCALE       \ Scale factor                                               XVAR EXPER#      \ Current experiment                    \ number                                                       XVAR #SERIES     \ Number of              \ experimental runs in the current      \ series.                                                                     XVAR SERIES#     \ Current run in a                      \ series of                             \ experiments                                                  X: SIZE  ( -- n )                          \ Array size for run of experiments     MAX-EXPERS 4 * 4 + X;                                                                                                                                                                                                                                                       \ FAH                                                                    \ EXPER-DATA VALUES      <11/ 6/86>190                                          XCREATE EXDATA                                   SIZE MAX-SERIES * ALLOT                                                X: DATA-PTS ( -- adr )                      \ Return ptr to head of array that      \ holds data for current run of         \ experiments                           EXDATA SERIES# @ SIZE * + X;                                                X: #EXPERS  ( -- adr )                      \ Ptr to number of experiments          \ that have been run in the series.     DATA-PTS SIZE + 2- X;                                                       : TEMP  ( -- adr )                          \ Ptr to temperature                    #EXPERS 2- ;                                                                                                                                                                                                                       \ FAH                                                                    \ VALUE !VAL @VAL !XVAL  <11/ 6/86>191                                          X: DATA-PT ( index -- adr )                \ Given SERIES#, index into array       \ of data associated with the run.      4 * DATA-PTS + X;                                                            X: !DATA-PT ( x y index -- )               \ Store xy pair                         DATA-PT D! X;                                                                X: @DATA-PT ( index -- x y )               \ Fetch xy pair                         DATA-PT D@ X;                                                                X: !XDATA-PT ( x index -- )                \ Store x                               DATA-PT 2+ ! X;                                                              X: !YDATA-PT ( y index -- )                \ Store y                               DATA-PT ! X;                                                                                                \ FAH                                                                    \ @XDATA-PT @YDATA-PT    <11/ 6/86>192                                          X: @XDATA-PT ( index -- x )                \ Fetch x                               @DATA-PT DROP X;                                                             X: @YDATA-PT ( index -- y )                \ Fetch y                               @DATA-PT SWAP DROP X;                                                        X: !DATA-PTS  ( X Y -- )                    EXPER# @ !DATA-PT X;                                                        X: @DATA-PTS ( -- X Y )                     EXPER# @ @DATA-PT X;                                                        X: XSCALE  ( n -- n )                       XMIN - XRANGE XMAX XMIN - */ X;                                             X: YSCALE  ( n -- n )                       YRANGE YMAX */ YRANGE SWAP - X;                                                                                                                    \ FAH                                                                    \ CASE: -3PIX -2PIX -1PIX<11/ 6/86>193  EXIT --------------------------- EXIT   : CASE:                                     :                                       DOES>                                     SWAP 2* + @ EXECUTE ;                                                     X: -3PIX  ( d -- )                          <#  # # # 46 HOLD #S #> GTYPE X;                                            X: -2PIX  ( d -- )                          <# # # 46 HOLD #S #> GTYPE X;                                               X: -1PIX  ( d -- )                          <# # 46 HOLD #S #> GTYPE X;                                                 X: GD.  ( d -- )                            <# #S #> GTYPE X;                                                           CASE:  .FORMAT                            -3PIX -2PIX -1PIX GD. GD. GD. ;                                                                                                                      \ FAH                                                                    \ .VALUE .Y .X           <11/20/86>194                                          X: #LEN ( N -- )                            S->D <# #S #> <STRLEN> X;                                                   X: .VALUE ( N -- )                          0 BUB/MAN @ 1 =                         IF <# #S #>  \ print as #           \ 0 or 2 print as #.#                       ELSE <# # 46 HOLD #S #> THEN            GTYPE X;                                                                    X: .Y ( N -- ) \ Print y value in hires     @YDATA-PT .VALUE X;                                                         X: .X ( N -- ) \ Print x value in hires     @XDATA-PT .VALUE X;                                                         EXIT ------- OLD VERSION ------- EXIT   X: .VALUE  ( n -- )                         \ Print a scaled number in hires        0 SCALE @ .FORMAT X;                                                                                       \ FAH                                                                    \ PUT-VALUES FRAME       <12/23/86>195                                          : >SCRPOS ( X Y -- X' Y' )                 \ scale data points to screen cords     0 MAX YMAX MIN                          YSCALE YPOS + SWAP                      0 MAX XMAX MIN                          XSCALE XPOS + SWAP ;                                                         X: PUT-VALUES  ( n -- x y )                \ Return screen cordinates of pt n      @DATA-PT >SCRPOS X;                                                          X: FRAME  ( -- )  \ Draw frame             2 SETMODE                               XPOS 7 - YPOS 5 - POINT                 XPOS XRANGE + 7 +                       YPOS          5 -  LINE-TO              XPOS XRANGE + 7 +                       YPOS YRANGE + 5 +  LINE-TO              XPOS          7 -                       YPOS YRANGE + 5 +  LINE-TO              XPOS 7 - YPOS 5 - LINE-TO X;                                        \ FAH                                                                    \ .XMIN .XMAX .XHALF     <11/20/86>196                                          X: .XMIN \ Print minimum x value             XPOS 2- YPOS                            YRANGE + 7 + !CURSOR XMIN G. X;    X: .XMAX \ Print maximum x value             XPOS XRANGE + XMAX #LEN 7 - - YPOS      YRANGE + 7 + !CURSOR XMAX G. X;    X: .XHALF \ Print maximum x value / 2        XMIN XMAX + 2/                          XPOS XRANGE 2/ + OVER #LEN 2/ - 2+      YPOS YRANGE + 7 + !CURSOR G. X;    X: .YMIN \ Print minimum y value             XPOS 26 - YPOS                          YRANGE + 4 - !CURSOR 0 .VALUE X;   X: .YMAX \ Print maximum y value             XPOS 26 - YPOS 4 -                      !CURSOR YMAX .VALUE X;             X: .YHALF \ Print maximum y value / 2        XPOS 26 -                               YPOS YRANGE 2 / + 4 -                   !CURSOR YMAX 2 / .VALUE X;                                                                                \ FAH                                                                    \ YMARGIN XMARGIN FACTOR <11/ 6/86>197                                           4 XCONSTANT YMARGIN  \ Margin for       6 XCONSTANT XMARGIN  \ tick marks                                              1 XCONSTANT FACTOR   \ Factor for ticks                                         X: XTICS   ( -- )                           XMAX 1+ XMIN DO                                    I XSCALE XPOS +                         YPOS YMARGIN 2 / -                      DDUP HPLOT                              YRANGE + YMARGIN + HPLOT               FACTOR +LOOP X;                                                   X: YTICS   ( -- )                           YMAX 1+ 0 DO                                       XPOS XMARGIN 2 / -                      I YSCALE YPOS +                         DDUP HPLOT                              SWAP XRANGE + XMARGIN                   + SWAP HPLOT                           FACTOR +LOOP X;                                          \ FAH                                                                    \ ?XRANGE ?YRANGE XYTICS <11/ 6/86>198                                          X: ?XRANGE  ( n -- f )                      XRANGE XMAX XMIN - */                   DUP 2 > SWAP XRANGE > NOT AND X;                                            X: ?YRANGE  ( n -- f )                      YRANGE YMAX */                          DUP 1 > SWAP YRANGE > NOT AND X;                                            X: XYTICS    ( n -- )                        \ Draw x and y ticks                    DUP ?XRANGE                                 IF                                         DUP X' FACTOR ! XTICS                   YMARGIN 2+ X' YMARGIN !              THEN                                    ?YRANGE                                 IF                                        DUP X' FACTOR ! YTICS                   XMARGIN 2+ X' XMARGIN !               THEN X;                                                                                               \ FAH                                                                    \ TICS                   <11/20/86>199                                          X: TICS \ Scale and draw x and y ticks     6 X' XMARGIN ! 4 X' YMARGIN ! 5000      BEGIN 5 / DUP XYTICS                      2 / DUP XYTICS ?DUP 0=                UNTIL X;                                                                     X: YLAB \ Label for ml O2                  4 SETMODE XPOS 26 -                     YPOS 17 - !CURSOR BUB/MAN @ 2 =         IF G." Absorbance"                      ELSE G." ml O"                           XPOS 3 + YPOS 15 - !CURSOR G." 2"      THEN X;                                                                      X: XLAB \ Label for micro Einsteins        4 SETMODE XPOS XRANGE + 5 -             YPOS YRANGE + 15 + !CURSOR              BUB/MAN @ 2 =                           IF -5 GX +! G." nm"                     ELSE G." uE"                            THEN X;                                                             \ FAH                                                                    \ DISPLACEMENT WIPEGRAPH <11/20/86>200                                          X: .GBOX                                   FRAME TICS 4 SETMODE                    .XMIN .XHALF .XMAX                      .YMIN .YHALF .YMAX                      XLAB YLAB X;                                                                 X: WIPEGRAPH \ -- Wipe coord. plane        1MODE                                   XRANGE 2+ YRANGE 2+                     XPOS 1- YPOS 1- BAR X;                                                       X: HDOT  ( x y -- )  \ Plot large dot      2MODE  DDUP    HPLOT                    DDUP SWAP 1- SWAP DDUP 1- HPLOT                                1+ HPLOT              SWAP 1+ SWAP DDUP 1- HPLOT                                1+ HPLOT X;                                                                                                                                                                                                  \ FAH                                                                    \ <DEPTH> !DEPTH MYDEPTH <11/ 6/86>201                                          XVARIABLE <DEPTH>                                                               X: !DEPTH                                   \ Store current depth                   DEPTH <DEPTH> ! X;                                                          X: MYDEPTH                                  \ Depth of array indices                DEPTH <DEPTH> @ - X;                                                        X: INDICES  ( -- N1 ... Nn  )               \ Put array indices on stack            #EXPERS @ 0                             DO I LOOP X;                                                                                                                                                                                                                                                                                                                                               \ FAH                                                                    \ BIOGRAPH -- DOCUMENTAT <11/ 6/86>202                                          EXIT                                                                            DSORT (next screen) is a variation      of the code in:                                                                      Turpin, Dr. Richard H.,                 Recursive Sort on the Stack,            Forth Dimensions,                       Vol. 5 No. 2, July/Aug 1983,            p. 16.                                                                     DSORT lets us sort an array by          manipulating the index values on the    stack.                                                                          DSORT assumes n index values on the     stack. The routine looks up the         values associated with each index       number and sorts accordingly.                                                                                                                          \ FAH                                                                    \ MYSELF SINK SORT       <11/ 6/86>203                                          : MYSELF                                    \ World famous word for recursion       LATEST PFA CFA , ; IMMEDIATE                                                : SINK                                      \ Support word for SORT                 MYDEPTH 1 >                             IF                                         OVER @XDATA-PT OVER @XDATA-PT           < IF                                        SWAP                                  THEN                                  >R                                      MYSELF                                  R>                                   THEN ;                                                                      X: SORT                                     \ Sort indices on stack                 MYDEPTH 1- 0   DO SINK LOOP X;                                                                             \ FAH                                                                    \ CONNECT GRAPH-EM       <12/23/86>204                                          X: CONNECT                                  \ Connect two points with line          2MODE                                   MYDEPTH                                 IF                                        PUT-VALUES POINT                        BEGIN                                     MYDEPTH                               WHILE                                     PUT-VALUES LINE-TO                    REPEAT                                THEN X;                                                                     X: GRAPH-EM                                 \ Draw continuous line graph            #EXPERS @                               IF !DEPTH INDICES SORT                   CONNECT                                THEN X;                                                                                                                                            \ FAH                                                                    \ PLOTTED PLOT-EM        <12/23/86>205                                          X: PLOTTED                                  \ Plot point                            1 SETMODE                               MYDEPTH                                 IF                                        PUT-VALUES HDOT                         BEGIN                                     MYDEPTH                               WHILE                                     PUT-VALUES HDOT                       REPEAT                                THEN X;                                                                     X: PLOT-EM                                  \ Plot all values in array              #EXPERS @                               IF !DEPTH INDICES SORT                   PLOTTED                                THEN X;                                                                                                                                            \ FAH                                                                    \ .O2/MIN BUBBLES        <11/ 6/86>206                                          X: .O2/MIN                                   \ Label O2/min                          4 SETMODE                               XPOS 26 - YPOS 17 -                     !CURSOR G." O"                          XPOS 16 - YPOS 15 -                     !CURSOR G." 2"                          XPOS  8 - YPOS 17 -                     !CURSOR G." /min" X;                                                       EXIT ---- NOT USED ---- EXIT            X: BUBBLES                                 \ Draw grid bubbles setup               40 TO YMAX                              FRAME TICS                              .XMIN .XHALF .XMAX                      .YMIN .YHALF .YMAX                      .UE .O2/MIN X;                                                                                                                                                                              \ FAH                                                                    \ PR.INTS                <11/ 6/86>207                                               \ Y position of data table         YPOS XCONSTANT COLUMN-Y                      \ X position of intensity          20   XCONSTANT INTS-COLUMN                   \ X position of O2 column          70   XCONSTANT O2-COLUMN                9    XCONSTANT TYSP                     \ X: TYSP                               \  BUB/MAN @ 2 = IF 8 ELSE 10 THEN X;                                           X: PR.INTS   ( -- )                         \ Prints column of intensity values     \ Assumes cursor is positioned and      \ SCALE is set.                         INTS-COLUMN COLUMN-Y !CURSOR            #EXPERS @ ?DUP                          IF 0                                     DO @CURSOR I @XDATA-PT G.                TYSP + !CURSOR                         LOOP                                   THEN X;                                                                                                                                     \ PR.O2                  < 2/10/87>208                                          X: PR.O2     ( -- )                         \ Prints column of intensity values     \ Assumes cursor is positioned and      \ SCALE is set.                         O2-COLUMN COLUMN-Y !CURSOR              #EXPERS @ ?DUP                          IF 0                                     DO @CURSOR I .Y                          TYSP + !CURSOR                         LOOP                                   THEN X;                                                                     X: PR.TEMP   ( -- )                        TEMP @ 5 * 10 + G. X;                                                                                                                                                                                                                                                                                                                                       \ FAH                                                                    \ BIO INPUT              <11/ 6/86>209                                          EXIT                                                                            XXGET and X.XGET are very specific      input routines for BIOLOGY. They        will accept any value between 0 and     TOP and 0.0 and TOP/10 respectively.                                            X.XGET expects a leading 0 and decimal  point if the value is < 1.                                                      The flag ACCEPTED will be true (1)      if a value is accepted.                                                         The value will be stored in DATUM.      X.X stores the value x 10 in DATUM.                                                                                                                                                                                                                                                                                    \ FAH                                                                    \ Input variables        <11/ 6/86>210                                          XVARIABLE ACCEPTED                        \ This flag is true if XXGET or         \ X.XGET accepts a value, else          \ false.                                                                      XVARIABLE DATUM                           \ If value is accepted by XXGET or      \ X.XGET, it is stored here. If         \ stored by X.XGET, value x 10 is       \ stored.                                                                     10 XCONSTANT TOP                          \ Maximum value accepted by XXGET.      \ Maximum value x 10 accepted by        \ X.XGET.                                                                                                                                                                                                                                                                                                            \ FAH                                                                    \ Input prims            <11/ 6/86>211                                          X: FAIL  ( n -- )                          \ n is number of tests that must        \ be passed for number to be            \ accepted.                             ACCEPTED ! X;                                                                X: ?PASS  ( f -- )                         IF -1 ACCEPTED +! THEN X;                                                    X: ?COUNT=  ( adr n -- )                   SWAP C@ = ?PASS X;                                                           X: ?SINGLE-DIGIT  ( adr adr -- )           - 2 = ?PASS X;                                                               X: ?.  ( adr -- ; is char a "." )           C@ ASCII . = ?PASS X;                                                       X: ?<TOP  ( n -- ; Is n > TOP? )            TOP > NOT ?PASS X;                                                                                         \ FAH                                                                    \ X.XNUMBER              <11/ 6/86>212                                          X: X.XNUMBER  ( adr -- n )                 \ Very specific number conversion       \ word. Only accepts numbers in         \ form of x.x, where x is any digit     \ between 0 and 9.                      5 FAIL                                  0 0 ROT                                 DUP       3 ?COUNT=                     DUP >R    CONVERT                       DUP R>    ?SINGLE-DIGIT                 DUP       ?.                            DUP >R    CONVERT                           R>    ?SINGLE-DIGIT                 DROP X;                                                                                                                                                                                                                                                                                                                                                     \ FAH                                                                    \ POS-CURS X.XGET        <11/21/86>213                                          XCREATE YMS \ Ymax for each exper typ     10 C, 40 C, 20 C,                     \ move cursor to proper place to        \ input next data item then erase       \ data field                            X: POS-CURS                                 #SERIES @ SERIES# !                     O2-COLUMN COLUMN-Y                      #EXPERS @ TYSP * + !CURSOR              0 HCOLOR 27 10 @CURSOR BAR X;                                               X: X.XGET  ( -- )                           \ Hires input routine for values        \ in range of 0.0 - 9.9.                \ Assumes Virtuoso programmer           \ has set mode.                         BUB/MAN @ YMS + C@ X' TOP !             POS-CURS PAD 3 GINPUT PAD X.XNUMBER     DUP ?<TOP DATUM !                       ACCEPTED @ 0= ACCEPTED ! X;                                                                                \ FAH                                                                    \ XXNUMBER               <11/ 6/86>214                                          X: XXNUMBER  ( adr -- n )                  \ Very specific number conversion       \ word. Only accepts numbers            \ less than or equal to TOP.            0 ACCEPTED !                            0 0 ROT CONVERT                         PAD C@ 0 > SWAP                         PAD PAD C@ + 1+ = AND                   3 PICK TOP > NOT AND                    ACCEPTED ! X;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ FAH                                                                    \ XXGET                  <11/21/86>215                                          X: XXGET  ( -- )                            \ Hires input routine for values        \ in range of 0 TOP.                    \ Assumes Virtuoso programmer           \ has set mode.                         POS-CURS                                BUB/MAN @ YMS + C@ X' TOP !             PAD TOP 0 <# #S #> SWAP DROP            GINPUT                                  PAD XXNUMBER ACCEPTED @                 IF DROP DATUM !                         ELSE DDROP                              THEN X;                                                                                                                                                                                                                                                                                                                                                                                            \ FAH                                                                    \ GRAPH-POS DRAW-GRAPH   <11/20/86>216                                          EXCODE: ( -- )                            @CURSOR X' YPOS ! X' XPOS ! EX;                                               KEY: GRAPH-POS                            LOADER INSCR? !EXCODE ;               [EXEC]                                  \ CREATE YMS \ Ymax for each exper typ  \ 10 C, 40 C, 20 C,                                                             \ draws graph border (type of graph     \ is set by EXPER-TYPE)                 EXCODE: ( -- )                            BUB/MAN @ YMS + C@ X' YMAX !            BUB/MAN @ 2 =                           IF 400 700 ELSE 0 2000 THEN             X' XMAX ! X' XMIN !                     .GBOX CLEANUP EX;                                                             KEY: DRAW-GRAPH                           LOADER INSCR? !EXCODE ;                                                                                      \ FAH                                                                    \ CLEAR-. GRAPH-. PLOT-. <11/ 6/86>217                                          EXCODE:                                   GMODE C@ WIPEGRAPH SETMODE CLEANUP    EX;                                     KEY: CLEAR-GRAPH                          LOADER INSCR? !EXCODE ;                                                                                               EXCODE:                                   GMODE C@ GRAPH-EM SETMODE CLEANUP EX;                                         KEY: GRAPH-RESULTS                        LOADER INSCR? !EXCODE ;                                                                                               EXCODE:                                   GMODE C@ PLOT-EM SETMODE CLEANUP EX;                                          KEY: PLOT-RESULTS                         LOADER INSCR? !EXCODE ;                                                                                                                              \ FAH                                                                    \ SERIES-INIT NEXT-SERIES<12/11/86>218                                          EXCODE: \ clean up everything             EXDATA \ clear array                    SIZE MAX-SERIES * 0 FILL                0 #SERIES ! 0 #EXPERS ! EX;                                                   KEY: SERIES-INIT                          LOADER INSCR? !EXCODE ;                                                       \ erase current experiment              EXCODE: 0 #EXPERS ! EX;                 KEY: EXPER-INIT                           LOADER INSCR? !EXCODE ;                                                       EXCODE:                                   #SERIES @ MAX-SERIES =                  DUP FLAG C! NOT                         IF 1 #SERIES +! #SERIES @ SERIES# !      0 #EXPERS ! THEN EX;                                                         KEY: NEXT-SERIES                          LOADER INSCR? !EXCODE ;                                              \ FAH                                                                    \ SET-SERIES# TABLE-POS  <11/ 6/86>219                                          EXCODE: ( N -- )                          DUP #SERIES @ > DUP FLAG C!             IF DROP #SERIES @ THEN                  DUP SERIES# ! TINT !                    CLEANUP EX;                                                                   KEY: SET-SERIES#                          LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                     EXCODE: ( N -- )                          GY @ X' COLUMN-Y !                      GX @ X' INTS-COLUMN !                   GX @ + X' O2-COLUMN !                 EX;                                                                             KEY: TABLE-POS                            LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                            \ FAH                                                                    \ NEXT-EXPER             <12/29/86>220                                          [EXEC]                                  X: XVALU ( -- V )                         INT# @ BUB/MAN @ 2 =                    IF 10 * 400 +                           ELSE ?DUP 0=                             IF 50 ELSE 100 * THEN                  THEN X;                                                                       \ copy data in then increment           EXCODE: ( -- )                             #SERIES @ SERIES# !                     XVALU   #EXPERS @ !XDATA-PT             DATUM @ #EXPERS @ !YDATA-PT             TEMP# @ TEMP ! 1 #EXPERS +!             #EXPERS @ MAX-EXPERS < NOT FLAG C!      EX;                                                                          KEY: NEXT-EXPER                           LOADER INSCR? !EXCODE ;                                                                                                                              \ FAH                                                                    \ GET-RESULT             <11/21/86>221                                          \ set FLAG if bad input                 EXCODE: ( -- )                            POS-CURS                                INTS-COLUMN GX !                        XVALU G.                                BUB/MAN @ 1 =                           IF XXGET ELSE X.XGET THEN               ACCEPTED @ NOT FLAG C!                  CLEANUP EX;                                                                   KEY: GET-RESULT                           LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ PR-INTS                <11/20/86>222                                          EXCODE: PR.INTS CLEANUP EX;                                                     KEY: PR-INTS                              LOADER INSCR? !EXCODE ;                                                                                               EXCODE: PR.O2 CLEANUP EX;                                                       KEY: PR-RESULTS                           LOADER INSCR? !EXCODE ;                                                                                               EXCODE: ( N -- ) BUB/MAN ! EX;          \ USE: EXPER-TYPE n                     \ n = 0=MAN 1=BUB 2=ABSORB              KEY: EXPER-TYPE                           LOADER INSCR?                           TYPES INT LOADER GET-EXPR               !EXCODE ;                                                                     [FORTH] FORGET XPOS                                                    \ FAH                                                                    \ TEST WORDS             <11/20/86>223                                          CREATE YMS 10 C, 40 C, 20 C,                                                    : DRAW-GRAPH \ ** CHANGED **              BUB/MAN @ YMS + C@ X' YMAX !            BUB/MAN @ 2 =                           IF 400 700 ELSE 0 2000 THEN             X' XMAX ! X' XMIN !                   \ FRAME TICS 4 SETMODE                  \ .XMIN .XHALF .XMAX                    \ .YMIN .YHALF .YMAX                    \ XLAB YLAB ;                             .GBOX ;                                                                       : DG                                      HGR 1 SETMODE 0 FS                      DRAW-GRAPH ;                                                                  : D PLOT-EM GRAPH-EM ;                                                                                                                                                                                                                                                  \ TEST WORDS             <11/20/86>224                                          : NEXT-EXPR \ ** CHANGED **                #SERIES @ SERIES# ! INT# @              BUB/MAN @ 2 U< IF 100 * THEN            #EXPERS @ !XDATA-PT                     DATUM @ #EXPERS @ !YDATA-PT             #EXPERS @ MAX-EXPERS =                  DUP FLAG C! NOT                         IF 1 #EXPERS +! THEN ;               : S DATUM ! INT# !                          NEXT-EXPR ;                                                                 : SERIES-INIT                              EXDATA \ clear array                    SIZE MAX-SERIES * 0 FILL                0 #SERIES ! 0 #EXPERS ! ;                                                    : NEXT-SERIES                              #SERIES @ MAX-SERIES =                  DUP FLAG C! NOT                         IF 1 #SERIES +! #SERIES @ SERIES# !      0 #EXPERS ! THEN ;                                                                                                                          \ 1CIR                   <11/ 7/86>225                                                                                  XCREATE 1CIR                              76 C, 56 C,   80 C, 50 C,               82 C, 44 C,   82 C, 38 C,               80 C, 32 C,   76 C, 26 C,               72 C, 22 C,                             62 C, 14 C,   54 C, 11 C,               44 C, 11 C,   36 C, 13 C,               29 C, 18 C,                             20 C, 27 C,   16 C, 35 C,               16 C, 43 C,   18 C, 49 C,               23 C, 57 C,   28 C, 62 C,               36 C, 67 C,   44 C, 69 C,               52 C, 69 C,   58 C, 68 C,               66 C, 64 C,                                                                                                                                                                                                                                                                                                          \ FAH                                                                    \ 1AAUX                  <11/ 7/86>226                                                                                  XCREATE 1AAUX                             82 C, 56 C,   80 C, 50 C,               -1 C,  0 C,   -1 C,  0 C,               76 C,  0 C,   76 C,  8 C,               70 C, 15 C,                             62 C, 14 C,   -1 C,  0 C,               21 C,  0 C,   21 C,  8 C,               21 C, 17 C,                             20 C, 27 C,   -1 C,  0 C,               -1 C,  0 C,   -1 C,  0 C,               23 C, 57 C,   25 C, 65 C,               26 C, 75 C,   26 C, 83 C,               -1 C,  0 C,   96 C, 67 C,               86 C, 62 C,                                                                                                                                                                                                                                                                                                          \ FAH                                                                    \ 1BAUX                  <11/ 7/86>227                                                                                  XCREATE 1BAUX                             82 C, 56 C,   80 C, 50 C,               -1 C,  0 C,   -1 C,  0 C,               76 C,  0 C,   76 C,  8 C,               70 C, 15 C,                             62 C, 14 C,   -1 C,  0 C,               21 C,  0 C,   21 C,  8 C,               21 C, 17 C,                             20 C, 27 C,   -1 C,  0 C,               -1 C,  0 C,   -1 C,  0 C,               -1 C,  0 C,   -1 C,  0 C,               -1 C,  0 C,   -1 C,  0 C,             \ 23 C, 57 C,   25 C, 65 C,             \ 26 C, 75 C,   26 C, 83 C,               -1 C,  0 C,   96 C, 67 C,               86 C, 62 C,                                                                                                                                                                                                                                                                                                   \ 2AUX                   <11/ 7/86>228                                                                                  CREATE 2AUX                               -1 C,  0 C,   -1 C,  0 C,               -1 C,  0 C,   -1 C,  0 C,               80 C, 32 C,   78 C, 29 C,               82 C, 23 C,                             90 C, 19 C,   98 C, 15 C,               -1 C,  0 C,   -1 C,  0 C,               -1 C,  0 C,                             -1 C,  0 C,   -1 C,  0 C,                2 C, 67 C,   12 C, 69 C,               20 C, 69 C,   28 C, 69 C,               36 C, 69 C,   44 C, 69 C,               -1 C,  0 C,   -1 C,  0 C,               -1 C,  0 C,                                                                                                                                                                                                                                                                                                          \ FAH                                                                    \ DRK CYCLE VARS         <11/ 7/86>229                                          XVARIABLE PT#                           2 XCONSTANT LLEN                                                                0 XCONSTANT XOFF                        0 XCONSTANT YOFF                                                                23 XCONSTANT #PTS                       0 XCONSTANT DPTS                                                                VARIABLE EPT#                                                                   1BAUX XCONSTANT 1AUX                                                                                                                                                                                                                                                                                                                                                                                                                           \ FAH                                                                    \ DRK CYCLE PRIMS        <11/ 7/86>230                                          X: @PT ( N -- X Y )                       #PTS + #PTS MOD                         2* DPTS + DUP C@ XOFF +                 SWAP 1+ C@ YOFF + X;                                                          XVARIABLE SLN                                                                   X: LN# ( N -- )                           DUP >R @PT OVER 255 XOFF + <            IF R> 1+ @PT OVER 255 XOFF + <           IF SLN @                                 IF DSWAP THEN                           LINE                                   ELSE DDROP DDROP THEN                  ELSE R> DROP DDROP                      THEN                                  X;                                                                                                                                                                                                                                     \ FAH                                                                    \ 1CYC                   <11/ 7/86>231                                          X: 1CYC 0 SLN !                           BEGIN 1CIR X' DPTS !                     1 SETMODE PT# @ LN#                     2 SETMODE PT# @ LLEN - LN#              1AUX X' DPTS !                          1 SETMODE PT# @ LN#                     2 SETMODE PT# @ LLEN - LN#              PT# @ 1+ #PTS MOD DUP PT# !             EPT# @ = UNTIL X;                                                            X: 1CYCB                                  XOFF DUP >R 96 + X' XOFF ! 1 SLN !      BEGIN 1CIR X' DPTS !                     1 SETMODE PT# @ LN#                     2 SETMODE PT# @ LLEN + LN#              2AUX X' DPTS !                          1 SETMODE PT# @ LN#                     2 SETMODE PT# @ LLEN + LN#              PT# @ 1- #PTS + #PTS MOD DUP PT# !      EPT# @ = UNTIL                         R> X' XOFF ! X;                                                                                                                               \ 2CYC                   <11/ 7/86>232  VARIABLE 2PT#                           : 2CYC                                    #PTS 11 + PT# @ - #PTS MOD 2PT# !       BEGIN 1CIR X' DPTS ! 0 SLN !             1 SETMODE PT# @ LN#                     2 SETMODE PT# @ LLEN - LN#              1AUX X' DPTS !                          1 SETMODE PT# @ LN#                     2 SETMODE PT# @ LLEN - LN#              XOFF DUP >R 96 + X' XOFF ! 1 SLN !      1CIR X' DPTS !                          1 SETMODE 2PT# @ LN#                    2 SETMODE 2PT# @ LLEN + LN#             2AUX X' DPTS !                          1 SETMODE 2PT# @ LN#                    2 SETMODE 2PT# @ LLEN + LN#             R> X' XOFF !                            2PT# @ 1- #PTS + #PTS MOD 2PT# !        PT# @ 1+ #PTS MOD DUP PT# !             EPT# @ =                             UNTIL ;                                                                                                        \ FAH                                                                    \                        <11/ 7/86>233                                          \ use: AT x , Y DR-CYC1A f , l          6 OWORD: ( f l )                          1BAUX X' 1AUX !                         EPT# ! PT# ! 1CYC O;                                                          \ use: AT x , Y DR-CYC1B f , l          7 OWORD: ( f l )                          1AAUX X' 1AUX !                         EPT# ! PT# ! 1CYC O;                                                          \ use: AT x , Y DR-CYC2A f , l          8 OWORD: ( f l )                          1BAUX X' 1AUX !                         EPT# ! PT# ! 2CYC O;                                                          \ use: AT x , Y DR-CYC2B f , l          9 OWORD: ( f l )                          1AAUX X' 1AUX !                         EPT# ! PT# ! 2CYC O;                                                                                                                                 \ FAH                                                                    \                        <11/17/86>234                                          \ use: AT X , Y CYC-POS                 10 OWORD: ( -- )                          GX @ X' XOFF !                          GY @ X' YOFF !                        O;                                                                              \ use: AT x , Y DR-CYC2B f , l          11 OWORD: ( f l )                         EPT# ! PT# ! 1CYCB O;                                                         \ NOW we remove extra heads             [FORTH]                                 FORGET 1CIR                                                                                                                                                                                                                                                                                                                                                                                            \ FAH                                                                    \ LDT                    <11/ 7/86>235                                          XCREATE LDT                              42 C, 52 C, 42 C, 52 C, \  8  9         42 C, 52 C, 42 C, 52 C, \ 10 11         42 C, 52 C, 42 C, 52 C, \ 12 13         42 C, 52 C, 42 C, 52 C, \ 14 15         42 C, 52 C,             \ 16            43 C, 51 C, 45 C, 49 C, \ 17 18         46 C, 48 C,             \ 19            46 C, 48 C, 46 C, 48 C, \ 20 21         0 C, 0 C,               \ 22            46 C, 48 C, 46 C, 48 C, \ 23 24          0 C,  0 C, 46 C, 48 C, \ 25 26         46 C, 48 C, 46 C, 48 C, \ 27 28         46 C, 48 C, 46 C, 48 C, \ 29 30         46 C, 48 C, 46 C, 48 C, \ 31 32         46 C, 48 C, 46 C, 48 C, \ 33 34                                                                                                                                                                                                                                               \ FAH                                                                    \ LDT                    <11/ 7/86>236                                           27 C, 67 C, 27 C, 67 C, \ 35 36         27 C, 67 C, 27 C, 67 C, \ 37 38         27 C, 67 C, 27 C, 67 C, \ 39 40         27 C, 67 C, 27 C, 67 C, \ 41 42         27 C, 67 C, 27 C, 67 C, \ 43 44         27 C, 67 C, 27 C, 67 C, \ 45 46         27 C, 67 C, 27 C, 67 C, \ 47 48         27 C, 67 C, 27 C, 67 C, \ 49 50         27 C, 67 C, 27 C, 67 C, \ 51 52         27 C, 67 C,             \ 53            28 C, 66 C, 29 C, 64 C, \ 54 55         31 C, 63 C, 32 C, 61 C, \ 56 57         33 C, 60 C, 35 C, 59 C, \ 58 59         36 C, 57 C, 38 C, 56 C, \ 60 61         39 C, 54 C, 41 C, 53 C, \ 62 63         42 C, 52 C, 44 C, 52 C, \ 64 65                                                                                                                                                                                                                                               \ FAH                                                                    \ DR LAB: Primitives     <11/ 7/86>237                                          0 XCONSTANT XOFF                        0 XCONSTANT YOFF                        X: DLN ( I -- )                           DUP 8 - 2* LDT +                        DUP C@ ?DUP                             IF XOFF + SWAP 1+ C@ XOFF +              SETENDPTS YOFF + HLINE                 ELSE DDROP THEN                       X;                                                                                                                      X: WT 1 SETMODE X;                      X: BK 2 SETMODE X;                                                              X: LDL                                     200 0 DO LOOP X;                                                             X: SDL                                     50 0 DO LOOP X;                                                                                                                                     \ FAH                                                                    \ RDROP                  <11/ 7/86>238                                          \ drop the radioactive stuff            X: RDROP                                \ draw first dribble                       WT 35 19 DO I DLN SDL LOOP           \ now start to empty top chamber          BK 17 8 DO I DLN LDL LOOP               35 17 DO I DLN SDL LOOP               X;                                                                              X: GLN ( Y -- ) \ draw line in faucet     DUP 72 = NOT OVER 99 = NOT AND          IF 44 XOFF + 50 XOFF + SETENDPTS         YOFF + HLINE                           ELSE DROP THEN X;                                                             X: KLN ( Y -- ) \ draw line in dish       24 XOFF + 68 XOFF + SETENDPTS           YOFF + HLINE                          X;                                                                                                                                                     \ FAH                                                                    \ GDROP                  <11/ 7/86>239                                          \ drop the goop into the killing dish   X: GDROP                                  5 SETMODE 11 HCOLOR                   \ draw first dribble                      111 65 DO I GLN LOOP                  \ now start to empty top chamber          65 35                                   DO BK I DLN 5 SETMODE                    110 I 35 - 4 / - KLN \ SDL             LOOP                                  \ now stop the faucet                     BK 103 65                               DO I GLN LOOP                         X;                                                                                                                                                                                                                                                                                                                                                             \ FAH                                                                    \ DO-C34                 < 2/10/87>240                                          \ clock position                        XVARIABLE CXY 0 ,   200 30 CXY D!       XVARIABLE TIME#                         \ moved to main memory                  \ XCREATE TIMES 0 , 0 , 0 ,                                                     X: #SECS ( -- ADR )                        TIME# @ TIMES + X;                                                           X: DO-C34                                 RDROP ?TERMINAL DROP 41 1               DO CXY D@ !CURSOR 5 SETMODE              I G. BL GEMIT                           I #SECS C! 2200                         BEGIN QTERM                              IF KEY BL =                              IF DROP 1 LEAVE THEN                   THEN                                    1- ?DUP 0= UNTIL                      LOOP                                    GDROP X;                                                             \ FAH                                                                    \                        <12/16/86>241                                          \ data for level 1 (C3)                 XCREATE C3D                             \ N    GLUC RUDP PGA  PGAL DPG  ---       1 C, 0 C, 0 C, 1 C, 0 C, 0 C, 0 C,      5 C, 0 C, 0 C, 2 C, 0 C, 1 C, 0 C,     10 C, 0 C, 0 C, 2 C, 1 C, 2 C, 0 C,     15 C, 0 C, 1 C, 2 C, 2 C, 2 C, 0 C,     20 C, 0 C, 2 C, 2 C, 2 C, 2 C, 0 C,     40 C, 2 C, 2 C, 2 C, 2 C, 2 C, 0 C,     99 C, 2 C, 2 C, 2 C, 2 C, 2 C, 0 C,                                            \ data for level 2 (C4)                 XCREATE C4D                             \ N    GLUC RUDP PGA  PGAL OAA  MALC      1 C, 0 C, 0 C, 0 C, 0 C, 1 C, 0 C,      2 C, 0 C, 0 C, 2 C, 0 C, 2 C, 1 C,      4 C, 0 C, 0 C, 2 C, 1 C, 2 C, 2 C,     13 C, 0 C, 1 C, 2 C, 2 C, 2 C, 2 C,     20 C, 1 C, 2 C, 2 C, 2 C, 2 C, 2 C,     40 C, 2 C, 2 C, 2 C, 2 C, 2 C, 2 C,     99 C, 2 C, 2 C, 2 C, 2 C, 2 C, 2 C,                                   \ FAH                                                                    \ C3S                    <11/ 7/86>242                                          X: FINDSTRIP ( TBL -- ADR )               BEGIN DUP C@ #SECS C@ <                 WHILE 7 + REPEAT 1+ X;                                                        \ Draws c3 strip at cursor              X: C3S                                    52 GX @ 7 / GY @ <DRAW>                 C3D FINDSTRIP                           5 0                                     DO DUP 4 I - + C@ ?DUP                   IF 52 + GX @ 7 /                         GY @ I 15 * + 6 + <DRAW> THEN         LOOP X;                                                                                                                                                                                                                                                                                                                                                                                              \ FAH                                                                    \ C4S                    <11/ 7/86>243                                          \ Draws c4 strip at cursor              X: C4S                                    52 GX @ 7 / GY @ <DRAW>                 C4D FINDSTRIP                           6 0                                     DO DUP 5 I - + C@ ?DUP                   IF 52 + GX @ 7 /                         GY @ I 12 * + 6 + <DRAW> THEN         LOOP X;                                                                       EXIT                                                                            : Q #SECS ! C4S ;                                                                                                                                                                                                                                                                                                                                                                                      \ FAH                                                                    \                        <12/23/86>244                                          0 OWORD: ( N -- ; SET-TIME# )              TIME# ! O;                           1 OWORD: ( -- ; CLK-LOC )                  @CURSOR CXY D! O;                    2 OWORD: ( -- ; RUN-C34 )                  DO-C34 O;                            3 OWORD: ( -- ; C3-STRIP )                 C3S O;                               4 OWORD: ( -- ; C4-STRIP )                 C4S O;                               5 OWORD: ( -- ; C34-POS )                  GX @ 7 / X' XOFF !                      GY @ X' YOFF ! O;                    6 OWORD: ( -- ; PR#SECS )                  #SECS C@ G. O;                                                               [FORTH] FORGET LDT                                                                                                                                                                                                                     \ FAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ OVERLAY STRUCTURE      <11/ 6/86>250  EXIT ---------- notes ----------- EXIT                                          Overlays are loaded at the top          of memory and are read using rwts       from the area starting at block 2                                               When the overlay is loaded DP is        reajusted up so that the overlay        is protected for stuff using PAD        The overlay is also relinked into       the dictionary at the top                                                       All words in the overlays must be       in the FORTH vocabulary, sub            vocabularies may be used if they        are defined in the overlay.  There is   no support for accessing vocabularies   outside of the overlay other than       FORTH.                                                                                                                                                                                         \ FAH                                                                    \ EXECUTING OVERLAY WORDS<11/ 6/86>251  EXIT ---------- notes ----------- EXIT                                          Each overlay begins with a table in the following format                                                                0-1  ID#                                2-3  save DP                            4-5  CURRENT @ @ (LFA of last word)     6-7  LFA of first word (NOT USED)       8-9  CFA of word 1                      10-11 "  "   "   2                                                              All routines are accesed through this   table                                                                           Common data areas/words will be loaded  before the overlays and will simply     be part of the main dictionary                                                                                                                                                                                                         \ FAH                                                                    \ OVERLAY VARIABLES      <11/ 6/86>252  [FORTH]                                 \ dp where overlays are loaded          0 CONSTANT OVSTART                                                              \ used to forget the overlay            0 CONSTANT OVLATEST                                                             \ size of overlay in sects              8 CONSTANT OVSECTS                                                              \ forget/remove overlay                 : 0OVERLAY                                [COMPILE] FORTH DEFINITIONS             OVSTART DP !                            OVLATEST CURRENT @ !                    \ force reload of next overlay          -1 OVSTART !                          ;                                                                                                                                                                                                                                      \ FAH                                                                    \ @OVERLAY               <11/ 6/86>253                                          \ Check if overlay is in memory         \ if not try to read it from drive A                                            \ overlays are 8 secs (2K) long and     \ start at sec 8 (blk 2)                                                        : @OVERLAY ( N -- ;N=0 to ?)              [COMPILE] FORTH DEFINITIONS             DUP OVSTART @ = NOT                     IF 0OVERLAY >R                           OVSTART 6 0                             R@ OVSECTS * 8 + 16 /MOD 1 8 RWTS       R> OVSTART @ = NOT                      EXEC RUN-ERR" Missing Overlay"          FORTH OVSTART 2+ @ DP !                 OVSTART 4 + @ CURRENT @ !              ELSE DROP THEN                        ;                                                                                                                                                                                              \ FAH                                                                    \ !OVERLAY OVSET         <11/ 6/86>254  APPENDIX                                \ Write overlay to disk                 : !OVERLAY ( N -- )                       [COMPILE] FORTH DEFINITIONS             ?NUM DUP OVSTART @ = NOT                IF DUP >R OVSTART !                      DP @ OVSTART 2+ !                       CURRENT @ @ OVSTART 4 + !               HERE OVSTART - 2048 U< NOT              ABORT" Overlay too big!"                OVSTART 6 0                             R> OVSECTS * 8 + 16 /MOD 0 8 RWTS      ELSE DROP                               THEN ;                                                                        \ set overlays to be loaded here        : OVSET                                   HERE 10 + ' OVSTART !                   CURRENT @ @ ' OVLATEST ! ;                                                    MAIN                                                                                                           \ FAH                                                                    \ START-OV               <11/ 6/86>255                                          APPENDIX                                                                        \ set variables to start an overlay     \ n is the number of spaces to reserve  \ for the routines                                                              : START-OV ( N -- )                       DEPTH 1 < ABORT" n START-OV"            0OVERLAY                                2* 8 + OVSTART + DP !                 ;                                                                               MAIN                                                                                                                                                                                                                                                                                                                                                                                                   \ FAH                                                                    \ OEXEC                  <11/ 6/86>256                                          \ execute routine n in overlay M                                                : OEXEC ( N M -- ; N=0 to ? )              @OVERLAY                                2* 8 + OVSTART + @ EXECUTE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \ OWORD:                 <11/ 6/86>257  APPENDIX                                                                        \ a defining word which plants          \ here into the table, and layes        \ down the CFA for :                                                            : OWORD: ( N -- ; n=0 to ? )              ?NUM >R HERE 255 AND 255 = ALLOT        HERE R> 2* 8 + OVSTART + !              SP@ CSP ! ' <:> , ] ;                                                         : O;                                      ?CSP COMPILE <EXIT>                     [COMPILE] [                           ; IMMEDIATE                                                                     MAIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \ NOTES                  < 4/16/87>259                                                                                  EXIT ----------- notes ----------- EXIT                                         The following words are the acutual     EXCODES and KEYWORDS for the rest       of the code on this disk.                                                       The execution part of all of these      words is simply a call to OEXEC which   will load the overlay and then run the  routine.                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \ FAH                                                                    \ OVERLAY CALLING NOTES  <11/ 6/86>260  [FORTH]                                                                         \ creates a keyword which has n ints    \ for arguments.  Done this way to      \ save space in virtual                                                         \ use: n INT: name                      : INT: ( N -- )                           ?NUM [KEYWORDS] CREATE C,               LOADER                                   \ find # of current excode              [ ' !EXCODE 4 + @ , ] 2+ C@ C,         DOES> >R INSCR? \ check if in def        \ compile n integer expressions         R@ C@ ?DUP                              IF 0                                     DO TYPES INT LOADER GET-EXPR LOOP      THEN                                    \ now store excode number               R> 1+ C@ C,OPDB                      ;                                                                                                                                                                                       \ 0: EXPER-POS CLOCK-POS <12/23/86>261                                                                                  EXCODE: 0 0 OEXEC EX;                                                           0 INT: EXPER-POS                        \ LOADER INSCR? !EXCODE ;                                                                                               EXCODE: 1 0 OEXEC EX;                                                           0 INT: CLOCK-POS                        \ LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ FAH                                                                    \ 0: SET-INT# SET-TEMP#  <12/23/86>262                                          EXCODE: ( N -- )                          2 0 OEXEC EX;                                                                 \ USE: SET-INT# n                       \ sets intensity index (INT#)           1 INT: SET-INT#                         \ LOADER 1INT !EXCODE ;                                                         EXCODE: ( N -- )                          3 0 OEXEC EX;                                                                 \ USE: SET-TEMP# n                      \ sets temperature index (TEMP#)        1 INT: SET-TEMP#                        \ LOADER 1INT !EXCODE ;                                                                                                                                                                                                                                                                                                \ FAH                                                                    \ 0: RUN-EXPER           <12/23/86>263                                          EXCODE: ( -- )                            BUB/MAN @ 2 =                           IF 1 4 OEXEC \ run absorbancey exper    ELSE 4 0 OEXEC \ run BUB or MAN exper   THEN                                  EX;                                                                             \ USE: RUN-EXPER                        \ execute experiment (type set by       \ EXPER-TYPE                            0 INT: RUN-EXPER                        \ LOADER INSCR? !EXCODE ;                                                       EXCODE: ( -- )                            5 0 OEXEC EX;                                                                 \ USE: SHOW-MAN                         \ redraw manomenter                     0 INT: SHOW-MAN                         \ LOADER INSCR? !EXCODE ;                                                                                      \ FAH                                                                    \ 1: RTIME PR-CYCLES     <12/23/86>264                                                                                  EXCODE: \ -- ;                            0 1 OEXEC EX;                                                                 0 INT: RTIME                            \ LOADER INSCR? !EXCODE ;                                                                                               EXCODE: \ --                              1 1 OEXEC EX;                                                                 0 INT: PR-CYCLES                        \ LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                              \ FAH                                                                    \ 1: L1POS L2POS         <12/23/86>265                                          EXCODE: ( N -- )                          2 1 OEXEC EX;                                                                 1 INT: L1POS                            \ LOADER 1INT !EXCODE ;                                                                                                 EXCODE: ( N -- )                          3 1 OEXEC EX;                                                                 1 INT: L2POS                            \ LOADER 1INT !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                                                        \ FAH                                                                    \ 1: ION H+              <12/23/86>266                                          EXCODE: ( -- )                            4 1 OEXEC EX;                                                                 \ use AT x , y ION                      0 INT: ION                              \ LOADER INSCR? !EXCODE ;                                                                                               EXCODE: ( -- )                            5 1 OEXEC EX;                                                                 \ use AT x , y H+                       0 INT: H+                               \ LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                                                                                                                      \ FAH                                                                    \ DR-CYC1A DR-CYC1B      <12/23/86>267                                          EXCODE: ( F L -- )                        6 1 OEXEC EX;                                                                 \ use: AT x , Y DR-CYC1A f , l          2 INT: DR-CYC1A                         \ LOADER 2INTS !EXCODE ;                                                        EXCODE: ( F L -- )                        7 1 OEXEC EX;                                                                 \ use: AT x , Y DR-CYC1B f , l          2 INT: DR-CYC1B                         \ LOADER 2INTS !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                               \ FAH                                                                    \ DR-CYC2A DR-CYC2B      <12/23/86>268                                          EXCODE: ( F L -- )                        8 1 OEXEC EX;                                                                 \ use: AT x , Y DR-CYC2A f , l          2 INT: DR-CYC2A                         \ LOADER 2INTS !EXCODE ;                                                                                                EXCODE: ( F L -- )                        9 1 OEXEC EX;                                                                 \ use: AT x , Y DR-CYC2B f , l          2 INT: DR-CYC2B                         \ LOADER 2INTS !EXCODE ;                                                                                                                                                                                                                                                                                                                                       \ FAH                                                                    \ CYC-POS                <12/23/86>269                                          EXCODE: ( -- ) 10 1 OEXEC EX;                                                   0 INT: CYC-POS                          \ LOADER INSCR? !EXCODE ;                                                       EXCODE: ( F L -- ) 11 1 OEXEC EX;                                               \ use: AT x , Y DR-CYC2C f , l          2 INT: DR-CYC2C                         \ LOADER 2INTS !EXCODE ;                                                                                                EXCODE: ( M N -- ) 12 1 OEXEC EX;                                               \ use: ION im, h+m                      2 INT: DRAW-ION                         \ LOADER 2INTS !EXCODE ;                                                                                                                                                                                                                                                                                        \ 2: SET-TIME# CLK-LOC RU<12/23/86>270                                          EXCODE: ( N -- )                         0 2 OEXEC EX;                                                                  1 INT: SET-TIME#                        \ LOADER 1INT !EXCODE ;                                                         EXCODE: ( -- )                            1 2 OEXEC EX;                                                                 0 INT: CLK-LOC                          \ LOADER INSCR? !EXCODE ;                                                                                               EXCODE: ( -- )                            2 2 OEXEC EX;                                                                 0 INT: RUN-C34                          \ LOADER INSCR? !EXCODE ;                                                                                                                                                                      \ FAH                                                                    \ 2: CS-ST. C4-ST. C34-PO<12/23/86>271                                          EXCODE: ( -- ) 3 2 OEXEC EX;                                                    0 INT: C3-STRIP                         \ LOADER INSCR? !EXCODE ;                                                                                               EXCODE: ( -- ) 4 2 OEXEC EX;                                                    0 INT: C4-STRIP                         \ LOADER INSCR? !EXCODE ;                                                                                               EXCODE: ( -- ) 5 2 OEXEC EX;                                                    0 INT: C34-POS                          \ LOADER INSCR? !EXCODE ;                                                       EXCODE: ( -- ) 6 2 OEXEC EX;                                                    0 INT: PR#SECS                          \ LOADER INSCR? !EXCODE ;                                              \ FAH                                                                    \ 3: CFORM               <12/23/86>272                                          EXCODE: ( M N -- )                        0 3 OEXEC EX;                                                                 2 INT: CFORM                            \ LOADER 2INTS !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \ 4: GET-BULB# GET-SOL#  <12/23/86>273                                          EXCODE: ( N -- )                          0 4 OEXEC EX;                                                                 \ return graphic# (in tint) for index   1 INT: GET-BULB#                        \ LOADER 1INT !EXCODE ;                                                                                                 \ Routine 1 is called by RUN-EXPR                                               EXCODE: ( -- )                            2 4 OEXEC EX;                                                                 0 INT: GET-SOL#                         \ LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                                                                              \ FAH                                                                    \ 4: METER-POS           <12/23/86>274                                          EXCODE: ( -- )                            3 4 OEXEC EX;                                                                 0 INT: METER-POS                        \ LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              \ FAH                                                                    \ GR-IDEAL               <12/23/86>275                                          EXCODE:                                   BUB/MAN @ 2 =                           IF 4 4 OEXEC                            ELSE 6 0 OEXEC                          THEN                                    CLEANUP                               EX;                                                                             0 INT: GR-IDEAL                         \ LOADER INSCR? !EXCODE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \ FAH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    